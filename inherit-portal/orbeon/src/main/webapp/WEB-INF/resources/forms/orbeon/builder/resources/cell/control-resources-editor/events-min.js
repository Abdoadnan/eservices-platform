(function(){var Builder,ControlSelector,LabelHintSelector,clickOrFocus;Builder=ORBEON.Builder;LabelHintSelector=".fr-editable .xforms-label, .fr-editable .xforms-hint, .fr-editable .xforms-text";ControlSelector=".xforms-control, .xbl-component";clickOrFocus=function(_arg){var eventOnControlLabel,eventOnEditor,target;target=_arg.target;target=$(target);eventOnEditor=target.closest(".fb-label-editor").is("*");eventOnControlLabel=(target.is(LabelHintSelector)||target.parents(LabelHintSelector).is("*"))&&target.parents(".fb-main").is("*");if(!(eventOnEditor||eventOnControlLabel)){return Builder.resourceEditorEndEdit();}};$(function(){$(document).on("click",clickOrFocus);$(document).on("focusin",clickOrFocus);$(".fb-main").on("click",LabelHintSelector,function(_arg){var currentTarget,tdWithControl,th,trWithControls;currentTarget=_arg.currentTarget;if(!_.isNull(Builder.resourceEditorCurrentControl)){Builder.resourceEditorEndEdit();}Builder.resourceEditorCurrentLabelHint=$(currentTarget);th=Builder.resourceEditorCurrentLabelHint.parents("th");Builder.resourceEditorCurrentControl=th.is("*")?(trWithControls=th.parents("table").find("tbody tr.fb-grid-tr").first(),tdWithControl=trWithControls.children(":nth-child("+(th.index()+1)+")"),tdWithControl.find(ControlSelector)):Builder.resourceEditorCurrentLabelHint.parents(ControlSelector).first();return Builder.resourceEditorStartEdit();});return Builder.controlAdded.add(function(containerId){var container,repeat;container=$(document.getElementById(containerId));Builder.resourceEditorCurrentControl=container.find(ControlSelector);repeat=container.parents(".fr-repeat").first();Builder.resourceEditorCurrentLabelHint=repeat.is("*")?repeat.find("thead tr th:nth-child("+(container.index()+1)+") .xforms-label"):container.find(".xforms-label");if(Builder.resourceEditorCurrentLabelHint.is("*")){return Builder.resourceEditorStartEdit();}});});}).call(this);